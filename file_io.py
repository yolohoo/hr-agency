"""
file_io.py - низкоуровневые операции с файлами
"""

import json


def load_applicants_from_file(filename):
    """
    Загружает данные о соискателях из JSON файла.
    """
    try:
        with open(filename, 'r', encoding='utf-8') as file:
            data = json.load(file)
    except FileNotFoundError:
        raise FileNotFoundError(f"Файл '{filename}' не найден.")
    except json.JSONDecodeError:
        raise ValueError(f"Файл '{filename}' поврежден или имеет неверный формат.")

    from applicant import Applicant
    applicants = []
    for item in data:
        applicant = Applicant.from_dict(item)
        applicants.append(applicant)

    return applicants


def save_applicants_to_file(applicants, filename):
    """
    Сохраняет данные о соискателях в JSON файл.
    """
    data = [applicant.to_dict() for applicant in applicants]

    with open(filename, 'w', encoding='utf-8') as file:
        json.dump(data, file, ensure_ascii=False, indent=2)


def create_test_database():
    """
    Создает тестовую базу данных соискателей.
    """
    from applicant import Applicant

    applicants = [
        # ========== Группа 1: Программисты ==========
        Applicant("Иванов", "Иван", "Иванович", "М", "1990-05-15", "Программист", 8, ["Английский"], 180000),
        Applicant("Петров", "Пётр", "Петрович", "М", "1995-08-22", "Программист", 6, ["Английский", "Немецкий"], 150000),
        Applicant("Сидорова", "Анна", "Сергеевна", "Ж", "1998-03-10", "Программист", 4, ["Английский"], 120000),
        Applicant("Козлов", "Дмитрий", "Александрович", "М", "1985-11-30", "Программист", 12, ["Английский", "Китайский"], 200000),
        Applicant("Васильева", "Мария", "Павловна", "Ж", "1992-07-18", "Программист", 7, ["Английский"], 160000),

        # ========== Группа 2: Бухгалтеры ==========
        Applicant("Смирнов", "Алексей", "Викторович", "М", "1988-02-14", "Бухгалтер", 10, ["Английский"], 140000),
        Applicant("Кузнецова", "Екатерина", "Михайловна", "Ж", "1994-09-25", "Бухгалтер", 5, ["Английский"], 95000),
        Applicant("Попов", "Сергей", "Иванович", "М", "1982-12-05", "Бухгалтер", 15, ["Английский", "Французский"], 170000),
        Applicant("Лебедева", "Ольга", "Дмитриевна", "Ж", "1997-04-19", "Бухгалтер", 3, ["Английский"], 85000),

        # ========== Группа 3: Менеджеры ==========
        Applicant("Новиков", "Михаил", "Сергеевич", "М", "1991-06-30", "Менеджер", 9, ["Английский", "Испанский"], 165000),
        Applicant("Михайлова", "Татьяна", "Андреевна", "Ж", "1996-01-15", "Менеджер", 4, ["Английский"], 110000),
        Applicant("Фёдоров", "Александр", "Николаевич", "М", "1987-10-08", "Менеджер", 11, ["Английский", "Китайский"], 190000),
        Applicant("Соколова", "Наталья", "Викторовна", "Ж", "1993-11-22", "Менеджер", 6, ["Английский"], 130000),

        # ========== Группа 4: ДИЗАЙНЕРЫ (для демонстрации всех 3 критериев) ==========
        Applicant("Кузнецов", "Артём", "Андреевич", "М", "1993-08-12", "Дизайнер", 6, ["Английский"], 140000),
        Applicant("Соловьёва", "Белла", "Викторовна", "Ж", "1995-04-23", "Дизайнер", 6, ["Английский"], 140000),
        Applicant("Иванов", "Владимир", "Петрович", "М", "1992-11-05", "Дизайнер", 6, ["Английский", "Немецкий"], 140000),
        Applicant("Васильев", "Геннадий", "Сергеевич", "М", "1996-02-17", "Дизайнер", 4, ["Английский"], 110000),
        Applicant("Петрова", "Дарья", "Игоревна", "Ж", "1998-07-30", "Дизайнер", 3, ["Английский"], 90000),

        # ========== Группа 5: Разные специальности ==========
        Applicant("Тихонов", "Евгений", "Валерьевич", "М", "1989-03-14", "Аналитик", 7, ["Английский"], 185000),
        Applicant("Логинова", "Жанна", "Сергеевна", "Ж", "1997-06-28", "Тестировщик", 2, ["Английский"], 80000),
        Applicant("Громов", "Захар", "Ильич", "М", "1990-09-11", "DevOps", 8, ["Английский", "Китайский"], 220000),
        Applicant("Дмитриева", "Ираида", "Алексеевна", "Ж", "1994-12-05", "HR-менеджер", 5, ["Английский"], 115000),
        Applicant("Калинин", "Константин", "Владимирович", "М", "1986-05-19", "Системный администратор", 13, ["Английский"], 195000),

        # ========== Группа 6: Дополнительные записи ==========
        Applicant("Никифоров", "Леонид", "Геннадьевич", "М", "1991-07-22", "Frontend-разработчик", 7, ["Английский"], 160000),
        Applicant("Орлова", "Маргарита", "Станиславовна", "Ж", "1996-03-14", "Backend-разработчик", 3, ["Английский"], 125000),
        Applicant("Павлов", "Никита", "Юрьевич", "М", "1988-11-30", "Data Scientist", 9, ["Английский", "Французский"], 210000),
        Applicant("Романова", "Оксана", "Витальевна", "Ж", "1995-01-25", "UX/UI дизайнер", 4, ["Английский"], 135000),
        Applicant("Соболев", "Павел", "Петрович", "М", "1993-06-08", "QA-инженер", 5, ["Английский"], 105000),
        Applicant("Тарасова", "Раиса", "Михайловна", "Ж", "1997-10-17", "Продуктовый менеджер", 1, ["Английский"], 95000)
    ]

    return applicants
